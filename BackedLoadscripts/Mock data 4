///$tab Main
SET ThousandSep=',';
SET DecimalSep='.';
SET MoneyThousandSep=',';
SET MoneyDecimalSep='.';
SET MoneyFormat='$ ###0.00;-$ ###0.00';
SET TimeFormat='h:mm:ss TT';
SET DateFormat='M/D/YYYY';
SET TimestampFormat='M/D/YYYY h:mm:ss[.fff] TT';
SET FirstWeekDay=6;
SET BrokenWeeks=1;
SET ReferenceDay=0;
SET FirstMonthOfYear=1;
SET CollationLocale='en-US';
SET CreateSearchIndexOnReload=1;
SET MonthNames='Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec';
SET LongMonthNames='January;February;March;April;May;June;July;August;September;October;November;December';
SET DayNames='Mon;Tue;Wed;Thu;Fri;Sat;Sun';
SET LongDayNames='Monday;Tuesday;Wednesday;Thursday;Friday;Saturday;Sunday';
SET NumericalAbbreviation='3:k;6:M;9:G;12:T;15:P;18:E;21:Z;24:Y;-3:m;-6:Î¼;-9:n;-12:p;-15:f;-18:a;-21:z;-24:y';

///$tab Automations
let vURL = 'https://madolf.eu.qlikcloud.com/api/v1/automations/';
let vAppId = DocumentName();
trace $(vAppId);

//automation1
  let vRequestBody = '{"appId":"' & '$(vAppId)'&'"}';
  let vRequestBody = replace(vRequestBody,'"', chr(34)&chr(34));
  let vToken = 'I9zzQVxp9enzT3U7mEaoVLq52CoUH25HKgJmOAbl5n3aUNvQXSEnz2aGfk7o3Xpa';
  let vAutomationId = 'ea35f680-3583-11ec-bc01-53c746f100db';
  LIB CONNECT TO 'POST_automation';
  RestConnectorMasterTable:
  SQL SELECT 
	"status",
	"guid"
  FROM JSON (wrap on) "root"
  WITH CONNECTION( 
   Url "$(vURL)$(vAutomationId)/actions/execute",
   HTTPHEADER "X-Execution-Token" "$(vToken)",
   BODY "$(vRequestBody)"
  );
  DROP TABLE RestConnectorMasterTable;


let vURL = null();
let vToken = null();
let vAutomationId = null();
let vRequestBody = null();
let vDim1Check = null();
///$tab Auto-generated section
///$autogenerated
Set dataManagerTables = '','MOCK_DATA (4)';
//This block renames script tables from non generated section which conflict with the names of managed tables

For each name in $(dataManagerTables) 
    Let index = 0;
    Let currentName = name; 
    Let tableNumber = TableNumber(name); 
    Let matches = 0; 
    Do while not IsNull(tableNumber) or (index > 0 and matches > 0)
        index = index + 1; 
        currentName = name & '-' & index; 
        tableNumber = TableNumber(currentName) 
        matches = Match('$(currentName)', $(dataManagerTables));
    Loop 
    If index > 0 then 
            Rename Table '$(name)' to '$(currentName)'; 
    EndIf; 
Next; 
Set dataManagerTables = ;


Unqualify *;

[MOCK_DATA (4)]:
LOAD
	[id],
	[first_name],
	[last_name],
	[email],
	[gender],
	[ip_address]
 FROM [lib://Blends:DataFiles/MOCK_DATA (4).csv]
(txt, codepage is 28591, embedded labels, delimiter is ',', msq);




