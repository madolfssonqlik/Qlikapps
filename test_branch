{"blocks":[{"id":"23781A46-3D2B-4E83-9642-5ED062726121","type":"StartBlock","x":100,"y":100,"disabled":false,"name":"AppPublished","displayName":"App Published","comment":"","childId":"4C75D24C-6C41-402B-8669-CF99DF4E3507","inputs":[{"id":"run_mode","value":"webhook","type":"select","structure":{}},{"id":"datasourcetype_guid","value":"61a87510-c7a3-11ea-95da-0fb0c241e75c","type":"select","displayValue":"Qlik Cloud Services","structure":[]},{"id":"webhook_event_guid","value":"365616d0-889f-11eb-a6c1-0fbe0dacf886","type":"select","displayValue":"App Published","structure":[]},{"id":"test_payload","value":"{\n  \"cloudEventsVersion\": \"0.1\",\n  \"source\": \"com.qlik/engine\",\n  \"contentType\": \"application/json\",\n  \"eventId\": \"dbce978f-17cd-4588-bfde-481544b7eb58\",\n  \"eventTime\": \"2021-09-06T18:31:10Z\",\n  \"eventTypeVersion\": \"1.0.0\",\n  \"eventType\": \"com.qlik.v1.app.published\",\n  \"extensions\": {\n    \"spaceId\": \"6131d9ae3ec592fe53a774bc\",\n    \"tenantId\": \"KuGA12XZN0c7A7MUGHTkJuXGx3QVwrdo\",\n    \"userId\": \"5-dSP_g22ekR3CivrMwXl-IeM-2h0-AD\"\n  },\n  \"data\": {\n    \"attributes\": {\n      \"id\": \"725d9105-7a49-4f7a-8f58-d0c14cb0d1de\",\n      \"name\": \"Sample data app\",\n      \"owner\": \"Auth0-ves\\\\\\\\auth0|5cdd19b12da9a1113b56cea8\",\n      \"originAppId\": \"725d9105-7a49-4f7a-8f58-d0c14cb0d1de\"\n    }\n  }\n}","type":"json","structure":[]},{"id":"webhook_documentation","value":null,"type":"string","structure":{}}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"logo":"https://cdn.qlikcloud.com/automations/logos/21dd4ad9985d490e7bfd7a644d783489.png"},{"id":"0DB8E9E2-1DA4-4B8E-B497-AB2980198EF8","type":"EndpointBlock","x":447.2083740234375,"y":1093.9896392822266,"disabled":false,"name":"createOrUpdateFileContents","displayName":"GitHub - Create Or Update File Contents","comment":"","childId":null,"inputs":[{"id":"c0370450-05a8-11ec-b854-2f300eb6fbf0","value":"{$.owner}","type":"string","structure":[]},{"id":"c046f740-05a8-11ec-8d20-9dcf87f2c165","value":"{$.repo}","type":"string","structure":[]},{"id":"c04fd120-05a8-11ec-8210-cb51bee674e4","value":"{$.GetAppInformation.info.attributes.description}","type":"string","structure":[]},{"id":"c059e560-05a8-11ec-8236-899ea1ccb8e8","value":"{$.getSpace.name}/{$.GetAppInformation.info.attributes.name}.qvf","type":"string","structure":[]},{"id":"c0707630-05a8-11ec-b3a0-b3314a2ce223","value":"{$.exportAppToBase64EncodedFile}","type":"string","structure":[]},{"id":"7b8fd570-05ab-11ec-81f9-dfee737c7710","value":"main","type":"string","structure":[]},{"id":"8fe536c0-05ab-11ec-9eee-79f5f7e4ea13","value":"{ $.listRepositoryContents.item.sha }","type":"string","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"datasourcetype_guid":"0d87808f-27c0-11ea-921c-022e6b5ea1e2","endpoint_guid":"c0096fc0-05a8-11ec-9c49-3d209ed5ca0f","endpoint_role":"create"},{"id":"491B9012-80C1-478E-9189-B41423348575","type":"SnippetBlock","x":260,"y":323,"disabled":false,"name":"GetAppInformation","displayName":"Qlik Cloud Services - Get App Information","comment":"","childId":"12B68CF6-D746-4D5E-A091-E5EF57244D40","inputs":[{"id":"0dcb28f0-f086-11eb-8c7b-539668fe85aa","value":"{$.AppPublished.data.attributes.id}","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"d3a8d4f0-a8d2-11eb-a81d-ffabb68491fb","snippet":{"guid":"d3a8d4f0-a8d2-11eb-a81d-ffabb68491fb","name":"Get app information","description":"The **Get App Information** block will return apps's metadata, lineage and regular information.\n\nThe block combines following raw API endpoints:\n - [Get App](https://qlik.dev/apis/rest/apps#%23%2Fentries%2Fapps%2F-appId-get)\n - [Get App Metadata](https://qlik.dev/apis/rest/apps#%23%2Fentries%2Fapps%2F-appId%2Fdata%2Fmetadata-get)\n - [Get App Lineage](https://qlik.dev/apis/rest/apps#%23%2Fentries%2Fapps%2F-appId%2Fdata%2Flineage-get)","snippet_datasource_id":null,"snippet_example_output":{"info":{"create":[{"resource":"sheet","canCreate":true},{"resource":"bookmark","canCreate":true},{"resource":"snapshot","canCreate":true},{"resource":"story","canCreate":true},{"resource":"dimension","canCreate":true},{"resource":"measure","canCreate":true},{"resource":"masterobject","canCreate":true},{"resource":"variable","canCreate":true}],"attributes":{"id":"0ea2ae08-bd07-4d9b-9207-3c69b6d43a0b","name":"Automotive Dealer Performance Analysis","owner":"QTSEL\\00upr9zq98GP1TOit0x7","custom":[],"ownerId":"dJhrOFvQOp608JelXiPUMNkaFGL6__er","encrypted":true,"published":false,"thumbnail":"/api/v1/apps/0ea2ae08-bd07-4d9b-9207-3c69b6d43a0b/media/files/thumbnail_Automotive---Dealer-Performance.png","createdDate":"2021-04-21T09:44:11.309Z","description":"Analyze how your automotive dealers are performing.  Gain insights across regions, dealers, branches and sales team.  Understand your product affinity and the effectiveness of campaigns.  Discover how to improve win rates.","originAppId":null,"publishTime":null,"dynamicColor":null,"modifiedDate":"2021-04-22T10:21:11.673Z","_resourcetype":"app","lastReloadTime":"2017-01-10T21:54:27.808Z","hasSectionAccess":false},"privileges":["read","update","delete","reload","export","duplicate","change_space","export_reduced","source"]},"lineage":[{"statement":null,"discriminator":"c:\\data\\automotive dealer performance\\competition.qvd;"},{"statement":null,"discriminator":"c:\\data\\automotive dealer performance\\fact.qvd;"},{"statement":null,"discriminator":"c:\\data\\automotive dealer performance\\mapdata.qvd;"},{"statement":null,"discriminator":"c:\\data\\automotive dealer performance\\productgroup.qvd;"},{"statement":null,"discriminator":"c:\\data\\automotive dealer performance\\sheet1.qvd;"}],"metadata":{"fields":[],"tables":[],"reload_meta":{"hardware":{"total_memory":0,"logical_cores":0},"cpu_time_spent_ms":0,"peak_memory_bytes":0},"static_byte_size":0,"has_section_access":false}},"snippet_endpoint_id":null,"role":"get","status":"live","inputs":[{"id":33,"guid":"0dcb28f0-f086-11eb-8c7b-539668fe85aa","prompt":"app_id","help_text":"\"do lookup\" retrieves first 500 apps.","type":"input","values":"","options":{"lookup_snippet_guid":"2af78370-0bc2-11ec-bca8-29eaabadff6d"},"is_required":true,"order":0}],"objecttype":"apps"}},{"id":"12B68CF6-D746-4D5E-A091-E5EF57244D40","type":"SnippetBlock","x":238,"y":749,"disabled":false,"name":"exportAppToBase64EncodedFile","displayName":"Qlik Cloud Services - Export App To Base 64 Encoded File","comment":"Export App without data","childId":"9417DF44-B4E9-485D-AD44-B24F5BAD9665","inputs":[{"id":"0dc7a1a0-f086-11eb-848d-bdadd6ab28a3","value":"{$.AppPublished.data.attributes.originAppId}","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"c08e2d30-8645-11eb-b98e-e77d5a1bebc3","snippet":{"guid":"c08e2d30-8645-11eb-b98e-e77d5a1bebc3","name":"export app to base64 encoded file","description":null,"snippet_datasource_id":null,"snippet_example_output":null,"snippet_endpoint_id":null,"role":"get","status":"live","inputs":[{"id":32,"guid":"0dc7a1a0-f086-11eb-848d-bdadd6ab28a3","prompt":"app_id","help_text":"Id of the app to export. Export will happen with NoData = true. \"do lookup\" retrieves first 500 apps.","type":"input","values":"","options":{"lookup_snippet_guid":"2af78370-0bc2-11ec-bca8-29eaabadff6d"},"is_required":true,"order":0}],"objecttype":"apps"}},{"id":"4C75D24C-6C41-402B-8669-CF99DF4E3507","type":"EndpointBlock","x":83,"y":199,"disabled":false,"name":"getSpace","displayName":"Qlik Cloud Services - Get Space","comment":"Check if the published space is a Production space","childId":"53691F19-49BF-4F09-8DF0-CD450F2168FD","inputs":[{"id":"92f7bcd0-6d2d-11eb-9088-69419de8f253","value":"{ $.AppPublished.extensions.spaceId }","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"92afefd0-6d2d-11eb-aee2-055653605a8e","endpoint_role":"get"},{"id":"0C4F793E-7009-449B-8340-7A11B0DF39DB","type":"IfElseBlock","x":138,"y":179,"disabled":false,"name":"condition","displayName":"Condition","comment":"Only App published in Production Spaces are versioned","childId":null,"inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{ $.getSpace.description }","input2":"Production","operator":"contain"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"childTrueId":"491B9012-80C1-478E-9189-B41423348575","childFalseId":null},{"id":"9F9748C7-D681-4EA9-9D54-11327E21CFCE","type":"EndpointBlock","x":181,"y":973,"disabled":false,"name":"SendMail","displayName":"Mail - Send Mail","comment":"","childId":"12FEABC3-A774-48FA-82F1-9F8C3043D58A","inputs":[{"id":"442845a0-cd00-11eb-9aa5-b966a68573b7","value":"{$.getUser.email}","type":"string","structure":[]},{"id":"543f08c0-cd00-11eb-b9c6-af8e23cc2439","value":null,"type":"string","structure":[]},{"id":"5cbdb1d0-cd00-11eb-8afd-ddd4ecc002ac","value":null,"type":"string","structure":[]},{"id":"72cad1e0-cd00-11eb-aa1b-3f42c1d22e38","value":"{ $.GetAppInformation.info.attributes.name } published to { $.getSpace.name }","type":"string","structure":[]},{"id":"79af8c50-cd24-11eb-a019-dfdc9a7f7317","value":"90ff46f0-cd24-11eb-bda1-0f1c7c213bfb","type":"select","displayValue":"html","structure":[]},{"id":"7d225d00-cd00-11eb-8493-055760e8b45a","value":"{json: {$.AppPublished}}\n\n\n{json: {$.createOrUpdateFileContents}}","type":"longtext","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"datasourcetype_guid":"05407a80-ccfd-11eb-b098-7140f6ac27f4","endpoint_guid":"84a79bf0-ccff-11eb-a508-7d415a725ea7","endpoint_role":"create"},{"id":"53691F19-49BF-4F09-8DF0-CD450F2168FD","type":"VariableBlock","x":104,"y":255,"disabled":false,"name":"owner","displayName":"Variable - owner","comment":"Github Repo owner change here","childId":"6D72BB90-DC0E-46BF-8A0C-04ACE42F3DB2","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"variableGuid":"778AD1F5-9278-4576-AB03-3A5D9BAF1F49","operations":[{"id":"set_value","key":"124F98BD-59B2-4978-B7BF-F72B599660B9","name":"Set value of { variable }","value":"expovin"}]},{"id":"6D72BB90-DC0E-46BF-8A0C-04ACE42F3DB2","type":"VariableBlock","x":98,"y":406,"disabled":false,"name":"repo","displayName":"Variable - repo","comment":"Github repo name change here","childId":"0C4F793E-7009-449B-8340-7A11B0DF39DB","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"variableGuid":"AEA68AF9-C1D8-4269-90E7-5154F3A65545","operations":[{"id":"set_value","key":"5DE13717-C7E1-4F83-B017-22412D7A4E55","name":"Set value of { variable }","value":"QlikSenseApps"}]},{"id":"12FEABC3-A774-48FA-82F1-9F8C3043D58A","type":"EndpointBlock","x":201,"y":1215,"disabled":false,"name":"sendMessage","displayName":"Microsoft Teams - Send Message","comment":"","childId":null,"inputs":[{"id":"ce80c8c0-d33a-11eb-a1be-fb85dcd48977","value":"8d7e5ff0-0cb7-44de-8236-cea13ab0e9d0","type":"string","displayValue":"GEAR","structure":[]},{"id":"ce8be4d0-d33a-11eb-aa74-37bc58fc7293","value":"19:a31fb551161b4c9cb477a26911d5bc8f@thread.skype","type":"string","displayValue":"QAA Test","structure":[]},{"id":"ce9788f0-d33a-11eb-a754-31a1e548ae07","value":"<h2>App Published in production</h2>\n<p>{$.AppPublished.data.attributes.name} published on {$.getSpace.name}</p>\n<p>App saved on Github repo {$.repo}on {$.owner}</p>\n<p>Github commit id: {$.createOrUpdateFileContents.commit.sha}</p>","type":"string","structure":[]},{"id":"cebb4240-d33a-11eb-86c4-cf0a4f744ace","value":null,"type":"string","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"datasourcetype_guid":"0d87af8f-27c0-11ea-921c-022e6b5ea1e2","endpoint_guid":"ce5ffe30-d33a-11eb-b284-3955388e8c59","endpoint_role":"create"},{"id":"F6B748D4-5B87-4981-8FD0-3E0364051383","type":"EndpointBlock","x":246.2083740234375,"y":1134.9896392822266,"disabled":false,"name":"getUser","displayName":"Qlik Cloud Services - Get User","comment":"","childId":"9F9748C7-D681-4EA9-9D54-11327E21CFCE","inputs":[{"id":"8eedf1d0-c7a5-11ea-9022-0fb2ce625902","value":"{$.AppPublished.extensions.userId}","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"7e670290-c7a5-11ea-9a9c-6dd2b282df86","endpoint_role":"get"},{"id":"9417DF44-B4E9-485D-AD44-B24F5BAD9665","type":"EndpointBlock","x":220.10418701171875,"y":1020.000030517578,"disabled":false,"name":"listRepositoryContents","displayName":"GitHub - List Repository Contents","comment":"","childId":"F6B748D4-5B87-4981-8FD0-3E0364051383","inputs":[{"id":"115b9570-a5b6-11ea-9a6e-c19e45e32536","value":"{$.owner}","type":"string","structure":[]},{"id":"1160aa10-a5b6-11ea-8ca5-176857bb7219","value":"{$.repo}","type":"string","structure":[]},{"id":"26c9bc30-a5b6-11ea-84b2-871be5fda74c","value":"{$.getSpace.name}","type":"string","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"maxitemcount","value":"","type":"string","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"loopBlockId":"BC4A7C29-3C46-48F2-833A-F72EA51C9AF6","datasourcetype_guid":"0d87808f-27c0-11ea-921c-022e6b5ea1e2","endpoint_guid":"114ad720-a5b6-11ea-bc2a-4d6dbd5cf425","endpoint_role":"search"},{"id":"BC4A7C29-3C46-48F2-833A-F72EA51C9AF6","type":"IfElseBlock","x":295.6770706176758,"y":967.3403167724608,"disabled":false,"name":"condition2","displayName":"Condition 2","comment":"","childId":null,"inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{ $.listRepositoryContents.item.name }","input2":"{$.GetAppInformation.info.attributes.name}.qvf","operator":"="},{"input1":"{$.listRepositoryContents.item.path}","input2":"{$.getSpace.name}/{$.GetAppInformation.info.attributes.name}.qvf","operator":"="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"childTrueId":"0DB8E9E2-1DA4-4B8E-B497-AB2980198EF8","childFalseId":null}],"variables":[{"guid":"778AD1F5-9278-4576-AB03-3A5D9BAF1F49","name":"owner","type":"string"},{"guid":"AEA68AF9-C1D8-4269-90E7-5154F3A65545","name":"repo","type":"string"}]}
